<?xml version="1.0" encoding="utf-8"?>
<dleplugin>
	<name>MaHarder Assets</name>
	<description>Универсальная административная панель для модификаций от MaHarder</description>
	<icon></icon>
	<version>2.0</version>
	<dleversion>14</dleversion>
	<versioncompare>greater</versioncompare>
	<upgradeurl></upgradeurl>
	<filedelete>1</filedelete>
	<needplugin></needplugin>
	<mnotice>0</mnotice>
	<mysqlinstall><![CDATA[DROP PROCEDURE IF EXISTS `DropColumnIfExists`;
DELIMITER $$
CREATE PROCEDURE `DropColumnIfExists` (`@TABLE` VARCHAR(100), `@COLUMN` VARCHAR(100))
`DropColumnIfExists`: BEGIN
    DECLARE `@EXISTS` INT UNSIGNED DEFAULT 0;

    SELECT COUNT(*) INTO `@EXISTS`
    FROM `information_schema`.`columns`
    WHERE (
        `TABLE_SCHEMA` = DATABASE()
        AND `TABLE_NAME` = `@TABLE`
        AND `COLUMN_NAME` = `@COLUMN`
    );

    IF (`@EXISTS` > 0) THEN
        SET @SQL = CONCAT('ALTER TABLE `', `@TABLE`, '` DROP COLUMN `', `@COLUMN`, '`;');

        PREPARE query FROM @SQL;
        EXECUTE query;
    END IF;
END $$

DELIMITER ;
DROP PROCEDURE IF EXISTS `RedoColumns`;
DELIMITER $$
CREATE PROCEDURE `RedoColumns` (`@TABLE` VARCHAR(100), `@COLUMN` VARCHAR(100), `@PARAMS` TEXT)
`RedoColumns`: BEGIN
    DECLARE `@EXISTS` INT UNSIGNED DEFAULT 0;

    SELECT COUNT(*) INTO `@EXISTS`
    FROM `information_schema`.`columns`
    WHERE (
        `TABLE_SCHEMA` = DATABASE()
        AND `TABLE_NAME` = `@TABLE`
        AND `COLUMN_NAME` = `@COLUMN`
    );

    IF (`@EXISTS` = 0) THEN
        SET @SQL = CONCAT('ALTER TABLE `', `@TABLE`, '` ADD `', `@COLUMN`, '` ', `@PARAMS`, '');

        PREPARE query FROM @SQL;
        EXECUTE query;
    END IF;
END $$

DELIMITER ;

create table {prefix}_languages
(
	id int auto_increment
		primary key,
	code varchar(5) null,
	flag varchar(255) null,
	name varchar(150) null,
	iso2 varchar(3) null,
	dir varchar(255) null,
	active tinyint(1) default 1 null,
	international varchar(255) null,
	constraint dle_languages_code_uindex
		unique (code)
);]]></mysqlinstall>
	<mysqlupgrade><![CDATA[INSERT INTO {prefix}_admin_sections
(name, title, descr, icon, allow_groups)
VALUES('maharder', 'MaHarder Assets v2.0.0', 'Настройки языков и отладки', DEFAULT, '1, 2')
ON DUPLICATE KEY UPDATE title = 'MaHarder Assets v2.0.0';]]></mysqlupgrade>
	<mysqlenable><![CDATA[INSERT INTO {prefix}_admin_sections
(name, title, descr, icon, allow_groups)
VALUES('maharder', 'MaHarder Assets v2.0.0', 'Настройки языков и отладки', DEFAULT, '1, 2')
ON DUPLICATE KEY UPDATE title = 'MaHarder Assets v2.0.0';]]></mysqlenable>
	<mysqldisable><![CDATA[DELETE FROM {prefix}_admin_sections WHERE name = 'maharder';]]></mysqldisable>
	<mysqldelete><![CDATA[DROP PROCEDURE IF EXISTS `DropColumnIfExists`;
DROP PROCEDURE IF EXISTS `RedoColumns`;
DROP TABLE {prefix}_languages;]]></mysqldelete>
	<phpinstall><![CDATA[]]></phpinstall>
	<phpupgrade><![CDATA[]]></phpupgrade>
	<phpenable><![CDATA[]]></phpenable>
	<phpdisable><![CDATA[]]></phpdisable>
	<phpdelete><![CDATA[]]></phpdelete>
	<notice><![CDATA[]]></notice>
	<file name="engine/inc/include/functions.inc.php">
		<operation action="replace">
			<searchcode><![CDATA['engine/skins/fonts/fontawesome/styles.min.css',]]></searchcode>
			<replacecode><![CDATA['engine/skins/maharder/css/fa_fix.css',
'engine/skins/maharder/css/fa_old.css',
'engine/skins/maharder/css/fa_new.css',]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA['engine/skins/javascripts/application.js',]]></searchcode>
			<replacecode><![CDATA['engine/skins/maharder/js/language.js',]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/include/init.php">
		<operation action="after">
			<searchcode><![CDATA[require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/include/functions.inc.php'));]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/languages.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/addnews.php">
		<operation action="after">
			<searchcode><![CDATA[<li id="tab-perimit"><a href="#tabperm" data-toggle="tab"><i class="fa fa-lock position-left"></i> {$lang['tabs_perm']}</a></li>]]></searchcode>
			<replacecode><![CDATA[
HTML;
			// MaHarder Assets
			require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tabs.php'));

echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[							<div class="form-group">
							  <label class="control-label col-md-2 col-sm-3">{$lang['vote_body']}<div class="text-muted text-size-small">{$lang['vote_str_1']}</div></label>
							  <div class="col-md-10 col-sm-9">
								<textarea rows="7" class="classic width-400" name="vote_body"></textarea>
							  </div>
							 </div>]]></searchcode>
			<replacecode><![CDATA[
HTML;
	// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/poll.table.php'));

					echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[<div class="panel-footer">]]></searchcode>
			<replacecode><![CDATA[
HTML;
	// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tabContent.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$id = $db->insert_id();]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/prePost.php'));]]></replacecode>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_poll (news_id, title, frage, body, votes, multiple, answer) VALUES('{$id}', '$vote_title', '$frage', '$vote_body', 0, '$allow_m_vote', '')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/poll.prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[	if( $_POST['tags'] != "" AND $approve ) {

		$tags = array ();

		$_POST['tags'] = explode( ",", $_POST['tags'] );

		foreach ( $_POST['tags'] as $value ) {

			$tags[] = "('" . $id . "', '" . trim( $value ) . "')";
		}

		$tags = implode( ", ", $tags );
		$db->query( "INSERT INTO " . PREFIX . "_tags (news_id, tag) VALUES " . $tags );

	}]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tags.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/banners.php">
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_banners (banner_tag, descr, code, approve, short_place, bstick, main, category, grouplevel, start, end, fpage, innews, devicelevel, allow_views, max_views, allow_counts, max_counts, rubric) values ('$banner_tag', '$banner_descr', '$banner_code', '$approve', '$short_place', '$bstick', '$main', '$category', '$grouplevel', '$start_date', '$end_date', '$fpage', '$innews', '$devicelevel', '$allow_views', '$max_views', '$allow_counts', '$max_counts', '$rub_id')" );]]></searchcode>
			<replacecode><![CDATA[	// MaHarder Assets
	$last_id = $db->insert_id();
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_banners SET banner_tag='$banner_tag', descr='$banner_descr', code='$banner_code', approve='$approve', short_place='$short_place', bstick='$bstick', main='$main', category='$category', grouplevel='$grouplevel', start='$start_date', end='$end_date', fpage='$fpage', innews='$innews', devicelevel='$devicelevel', allow_views='$allow_views', max_views='$max_views', allow_counts='$allow_counts', max_counts='$max_counts', rubric='$rub_id' WHERE id='$id'" );]]></searchcode>
			<replacecode><![CDATA[	$last_id = $id;
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_banners_rubrics (parentid, title, description) values ('{$parent}', '{$title}', '{$description}')" );]]></searchcode>
			<replacecode><![CDATA[	// MaHarder Assets
$last_id = $db->insert_id();
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/rubrics.prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_banners_rubrics SET title='{$title}', description='{$description}' WHERE id='{$editrubricid}'" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
$last_id = $editrubricid;
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/rubrics.prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$banner_descr = htmlspecialchars( $row['descr'], ENT_QUOTES, $config['charset'] );]]></searchcode>
			<replacecode><![CDATA[		require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/bannersView.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[		<div class="form-group">
		  <label class="control-label col-md-2 col-sm-3">{$lang['banners_xdescr']}</label>
		  <div class="col-md-10 col-sm-9">
			<input class="form-control width-350" type="text" name="banner_descr" maxlength="200" value="{$banner_descr}" />
		  </div>
		 </div>]]></searchcode>
			<replacecode><![CDATA[
HTML;
	// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/bannersDescr.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$r_list .= "
			<tr>
			 <td class=\"{$border}cursor-pointer\" onclick=\"document.location = '?mod=banners&rubric={$value['id']}'; return false;\"><h6 id=\"title_{$value['id']}\" class=\"media-heading text-semibold\">{$value['title']}</h6><div class=\"text-muted text-size-small\">{$value['description']}</div><textarea id=\"descr_{$value['id']}\" style=\"display:none;\">{$value['description']}</textarea></td>
			 <td class=\"{$border}text-center\" style=\"width: 70px\">{$menu_link}</td>
		   </tr>";]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
$r_list .= "
			<tr>
			 <td class=\"{$border}cursor-pointer\" onclick=\"document.location = '?mod=banners&rubric={$value['id']}'; return false;\"><h6 id=\"title_{$value['id']}\" class=\"media-heading text-semibold\">{$value['title']}</h6><div class=\"text-muted text-size-small\">{$value['description']}</div><textarea id=\"descr_{$value['id']}\" style=\"display:none;\">{$value['description']}</textarea>";
	
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/rubrics.table.php'));

			 $r_list .= "</td>
			 <td class=\"{$border}text-center\" style=\"width: 70px\">{$menu_link}</td>
		   </tr>";]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[b[dle_act_lang[2]] = function() { 
	 				if ( $("#dle-promt-title").val().length < 1) {
	 					 $("#dle-promt-title").addClass('ui-state-error');
	 				} else {
	 					$("#addrubric").submit();
	 				}			
	 			};
   
	 $("#dlepopup").remove();

	$("body").append("<div id='dlepopup' title='{$lang['add_rubric_1']}' style='display:none'><form id='addrubric' method='post'>{$lang['rubric_title']}<input type='hidden' name='mod' value='banners'><input type='hidden' name='action' value='addrubric'><input type='hidden' name='user_hash' value='{$dle_login_hash}'><input type='hidden' name='rubric' value='{$rubric}'><br /><input type='text' name='title' id='dle-promt-title' class='classic' style='width:100%;' value=''><br /><br />{$lang['rubric_description']}<br /><textarea name='description' id='dle-promt-descr' class='classic' style='width:100%;' rows='3'></textarea></form></div>");
]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/rubrics.addRubric.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[			b[dle_act_lang[2]] = function() { 
						if ( $("#dle-promt-title").val().length < 1) {
							 $("#dle-promt-title").addClass('ui-state-error');
						} else {
							$("#editrubric").submit();
						}					
					};
	
			$("#dlepopup").remove();

		$("body").append("<div id='dlepopup' title='{$lang['add_rubric_2']}' style='display:none'><form id='editrubric' method='post'>{$lang['rubric_title']}<input type='hidden' name='mod' value='banners'><input type='hidden' name='action' value='editrubric'><input type='hidden' name='user_hash' value='{$dle_login_hash}'><input type='hidden' name='editrubricid' value='"+rid+"'><br /><input type='text' name='title' id='dle-promt-title' class='classic' style='width:100%;' value='"+title+"'><br /><br />{$lang['rubric_description']}<br /><textarea name='description' id='dle-promt-descr' class='classic' style='width:100%;' rows='3'>"+description+"</textarea></form></div>");]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/banners/rubrics.editRubric.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/categories.php">
		<operation action="before">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . USERPREFIX . "_admin_logs (name, date, ip, action, extras) values ('".$db->safesql($member_id['name'])."', '{$_TIME}', '{$_IP}', '12', '{$cat_name}')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/categories/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$row['fulldescr'] = $parse->decodeBBCodes( $row['fulldescr'], false );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/categories/preEdit.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[  <div class="panel-heading">
    {$lang['cat_edit']}
  </div>]]></searchcode>
			<replacecode><![CDATA[  <div class="panel-heading">
    <ul class="nav nav-tabs nav-tabs-solid">
		<li class="active"><a href="#native" data-toggle="tab"><i class="fa fa-home position-left"></i> {$lang['cat_edit']}</a></li>
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tabs.php'));

	echo <<<HTML
	</ul>
    <div class="heading-elements">
		<ul class="icons-list">
			<li><a href="#" class="panel-fullscreen"><i class="fa fa-expand"></i></a></li>
		</ul>
    </div>
  </div>
  <div class="panel-tab-content tab-content">
  <div class="tab-pane active" id="native">]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[   </div>
	<div class="panel-footer">
		<button type="submit" class="btn bg-teal btn-sm btn-raised position-left"><i class="fa fa-floppy-o position-left"></i>{$lang['user_save']}</button>
	</div>]]></searchcode>
			<replacecode><![CDATA[   </div>
   </div>
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/categories/tabContent.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . USERPREFIX . "_admin_logs (name, date, ip, action, extras) values ('".$db->safesql($member_id['name'])."', '{$_TIME}', '{$_IP}', '14', '{$cat_name}')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/categories/postEdit.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[		<div class="form-group">
			<div class="row">
				<div class="col-sm-12">
					<label>{$lang['meta_keys']}</label>
					<textarea name="keywords" class="classic" style="width:100%;" rows="3"></textarea>
				</div>
			</div>
		</div>]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/categories/addCat.php'));

echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/editnews.php">
		<operation action="replace">
			<searchcode><![CDATA[		if(!$_REQUEST['search_area']) {
			$where[] = "(title like '%{$search_field}%' OR short_story like '%{$search_field}%' OR full_story like '%{$search_field}%' OR xfields like '%{$search_field}%')";
		} elseif($_REQUEST['search_area'] == 1) {
			$where[] = "title like '%{$search_field}%'";
		} elseif($_REQUEST['search_area'] == 2) {
			$where[] = "short_story like '%{$search_field}%'";
		} elseif($_REQUEST['search_area'] == 3) {
			$where[] = "full_story like '%{$search_field}%'";
		} elseif($_REQUEST['search_area'] == 4) {
			$where[] = "xfields like '%{$search_field}%'";
		} elseif($_REQUEST['search_area'] == 5) {
			$where[] = "tags like '%{$search_field}%'";
		}]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets

require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/editnews/search_area.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[	if( $_REQUEST['search_order_v'] == "asc" or $_REQUEST['search_order_v'] == "desc" ) $search_order_v = $_REQUEST['search_order_v'];
	else $search_order_v = "";]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	if( $_REQUEST['search_lang']  ) $search_lang = $_REQUEST['search_lang'];
	else $search_lang = "";]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[	$search_area = array();]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	$search_order_lang = array ('----' => '');
	foreach ($i18n_lang['active'] as $code => $lang_ar) {
		if ($i18n->getLocale() == $code) continue;
		$search_order_lang[$lang_ar['iso2']] = '';
	}
	if( ! empty( $search_lang ) ) {
		$search_order_lang[$search_lang] = 'selected';
	} else {
		$search_order_lang['----'] = 'selected';
	}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[	if( isset( $_REQUEST['search_area'] ) ) {
		$_REQUEST['search_area'] = intval($_REQUEST['search_area']);
		$search_area[$_REQUEST['search_area']] = 'selected';
	} else {
		$search_area[0] = 'selected';
	}]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	$selectFields = [];
	foreach ($i18n_lang['active'] as $code => $lang_ar) {
		if ($i18n->getLocale() == $code) continue;
		$selectFields[] = "p.title_{$lang_ar['iso2']}";
	}
	$selectFields = implode(', ', $selectFields);]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$db->query( "SELECT p.id, p.date, p.title, p.category, p.autor, p.alt_name, p.comm_num, p.approve, p.fixed, e.news_read, e.votes, e.user_id, e.need_pass FROM " . PREFIX . "_post p LEFT JOIN " . PREFIX . "_post_extras e ON (p.id=e.news_id) " . $where . " ORDER BY " . $order_by . " LIMIT {$start_from},{$news_per_page}" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets

$db->query( "SELECT p.id, p.date, p.title, {$selectFields}, p.category, p.autor, p.alt_name, p.comm_num, p.approve, p.fixed, e.news_read, e.votes, e.user_id, e.need_pass FROM " . PREFIX . "_post p LEFT JOIN " . PREFIX . "_post_extras e ON (p.id=e.news_id) " . $where . " ORDER BY " . $order_by . " LIMIT {$start_from},{$news_per_page}" );]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$entries .= "</td><td class=\"hidden-xs cursor-pointer text-center\" onclick=\"document.location = '?mod=editnews&action=editnews&id={$row['id']}'; return false;\">{$my_cat}</td>";]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
include (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/editnews/table.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[                    <input name="search_field" value="{$search_field}" type="text" class="form-control">
					<span class="input-group-btn">
						<select name="search_area" class="uniform form-control"><option value="0" {$search_area[0]}>{$lang['filter_search_0']}</option><option value="1" {$search_area[1]}>{$lang['filter_search_3']}</option><option value="2" {$search_area[2]}>{$lang['filter_search_4']}</option><option value="3" {$search_area[3]}>{$lang['filter_search_5']}</option><option value="4" {$search_area[4]}>{$lang['filter_search_6']}</option><option value="5" {$search_area[5]}>{$lang['filter_search_10']}</option></select>
					</span>]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets

	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/editnews/filter.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[        <th class="hidden-xs text-center">{$lang['edit_cl']}</th>
        <th class="hidden-xs hidden-sm" style="max-width: 140px">{$lang['edit_autor']}</th>]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets

		require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/editnews/tableHeader.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$access = permload( $row['access'] );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/editnews/preEdit.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$poll['multiple'] = $poll['multiple'] ? "checked" : "";]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets

require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/editnews/poll.preEdit.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[<li id="tab-perimit"><a href="#tabperm" data-toggle="tab"><i class="fa fa-lock position-left"></i> {$lang['tabs_perm']}</a></li>]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets

	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tabs.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[							<div class="form-group">
							  <label class="control-label col-md-2 col-sm-3">{$lang['vote_body']}<div class="text-muted text-size-small">{$lang['vote_str_1']}</div></label>
							  <div class="col-md-10 col-sm-9">
								<textarea rows="7" class="classic width-400" name="vote_body">{$poll['body']}</textarea>
							  </div>
							 </div>]]></searchcode>
			<replacecode><![CDATA[
HTML;

	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/poll.table.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[</div>
				<div class="panel-footer">
					<button type="submit" class="btn bg-teal btn-sm btn-raised position-left"><i class="fa fa-floppy-o position-left"></i>{$lang['news_save']}</button>]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets

	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tabContent.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_post SET title='{$title}', date='{$thistime}', short_story='{$short_story}', full_story='{$full_story}', xfields='{$filecontents}', descr='{$metatags['description']}', keywords='{$metatags['keywords']}', category='{$category_list}', alt_name='{$alt_name}', allow_comm='{$allow_comm}', approve='{$approve}', allow_main='{$allow_main}', fixed='{$news_fixed}', allow_br='{$allow_br}', symbol='{$catalog_url}', tags='{$_POST['tags']}', metatitle='{$metatags['title']}' WHERE id='{$item_db[0]}'" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/editnews/post.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$count = $db->super_query( "SELECT COUNT(*) as count FROM " . PREFIX . "_poll WHERE news_id = '$item_db[0]'" );

					if( $count['count'] ) $db->query( "UPDATE  " . PREFIX . "_poll set title='$vote_title', frage='$frage', body='$vote_body', multiple='$allow_m_vote' WHERE news_id = '$item_db[0]'" );
					else $db->query( "INSERT INTO " . PREFIX . "_poll (news_id, title, frage, body, votes, multiple, answer) VALUES('$item_db[0]', '$vote_title', '$frage', '$vote_body', 0, '$allow_m_vote', '')" );
]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/poll.prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/editvote.php">
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_vote (category, vote_num, date, title, body, approve, start, end, grouplevel) VALUES ('$category', 0, CURRENT_DATE(), '$title', '$body', '1', '$start_date', '$end_date', '$grouplevel')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/poll/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_vote SET category='$category', title='$title', body='$body', start='$start_date', end='$end_date', grouplevel='$grouplevel' WHERE id=$id" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/poll/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$row = $db->super_query( "SELECT id, title, category, body, vote_num FROM " . PREFIX . "_vote WHERE id='$id'" );]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	$selectTitle = '';
	$selectBody = '';
	foreach ($i18n_lang['active'] as $code => $lang_ar) {
		$iso = $lang_ar['iso2'];
		if ($i18n->getLocale() == $code) {
			$selectBody = "body_{$iso} as body";
			$selectTitle = "title_{$iso} as title";
		}
	}

	$row = $db->super_query( "SELECT id, {$selectTitle}, category, {$selectBody}, vote_num FROM " . PREFIX . "_vote WHERE id='$id'" );
	// END]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[		<div class="form-group">
		  <label class="control-label col-md-2 col-sm-3">{$lang['addnews_cat']}</label>]]></searchcode>
			<replacecode><![CDATA[
HTML;

	// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/poll/title.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[<div class="form-group">
		  <label class="control-label col-md-2 col-sm-3">{$lang['vote_body']}<br /><span class="note large">{$lang['vote_str_1']}</span></label>
		  <div class="col-md-10 col-sm-9">
			<textarea class="classic width-500" style="height:200px;" name="body" id="body">{$body}</textarea>
		  </div>
		 </div>]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets

	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/poll/body.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/email.php">
		<operation action="replace">
			<searchcode><![CDATA[	$db->query( "UPDATE " . PREFIX . "_email SET template='$reg_mail_text', use_html='$reg_mail_html' WHERE name='reg_mail'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$feed_mail_text', use_html='$feed_mail_html' WHERE name='feed_mail'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$lost_mail_text', use_html='$lost_mail_html' WHERE name='lost_mail'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$new_news_text', use_html='$new_news_html' WHERE name='new_news'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$new_comments_text', use_html='$new_comments_html' WHERE name='comments'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$new_pm_text', use_html='$new_pm_html' WHERE name='pm'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$new_newsletter_text', use_html='1' WHERE name='newsletter'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$wait_mail_text', use_html='$wait_mail_html' WHERE name='wait_mail'" );
	$db->query( "UPDATE " . PREFIX . "_email SET template='$twofactor_text', use_html='$twofactor_html' WHERE name='twofactor'" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/email/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . USERPREFIX . "_admin_logs (name, date, ip, action, extras) values ('".$db->safesql($member_id['name'])."', '{$_TIME}', '{$_IP}', '31', '')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
//$db->query( "INSERT INTO " . USERPREFIX . "_admin_logs (name, date, ip, action, extras) values ('".$db->safesql($member_id['name'])."', '{$_TIME}', '{$_IP}', '31', '')" );]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->free();]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/email/list.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="reg_mail_text">{$mail_template['reg_mail']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;
// MaHarder Assets

	createTabs('reg_mail');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="feed_mail_text">{$mail_template['feed_mail']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('feed_mail');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="lost_mail_text">{$mail_template['lost_mail']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('lost_mail');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="new_news_text">{$mail_template['new_news']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('new_news');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="new_comments_text">{$mail_template['comments']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('comments');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="new_pm_text">{$mail_template['pm']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('pm');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="wait_mail_text">{$mail_template['wait_mail']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('wait_mail');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="twofactor_text">{$mail_template['twofactor']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('twofactor');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[<textarea class="classic" rows="15" style="width:100%;" name="new_newsletter_text">{$mail_template['newsletter']}</textarea>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	createTabs('newsletter');

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/question.php">
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_question (question, answer) VALUES ('{$question}', '{$answer}')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/question/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_question SET question='{$question}', answer='{$answer}' WHERE id='{$id}'" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/question/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$row['answer'] = htmlspecialchars( stripslashes($row['answer']), ENT_QUOTES, $config['charset'] );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/question/tableReplace.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[style=\"display:none\">{$row['answer']}</div>]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
{$tableReplaces}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$('body').append("<div id='dlepopup' title='{$lang['opt_question_2']}' style='display:none'><form action=\"?mod=question\" method=\"POST\" name=\"saveform\" id=\"saveform\">{$lang['opt_question_3']}<br><input type='text' name='question' id='question' class='classic' style='width:100%' value=''/><br><br>{$lang['opt_question_4']}<br /><textarea name='answer' id='answer' class='classic' style='width:100%;height:100px;'></textarea><input type=\"hidden\" name=\"mod\" value=\"question\"><input type=\"hidden\" name=\"user_hash\" value=\"{$dle_login_hash}\"><input type=\"hidden\" name=\"action\" value=\"addquestion\"></form></div>");]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/question/addQuestion.php'));

echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$('body').append("<div id='dlepopup' title='{$lang['opt_question_2']}' style='display:none'><form action=\"?mod=question\" method=\"POST\" name=\"saveform\" id=\"saveform\">{$lang['opt_question_3']}<br><input type='text' name='question' id='question' class='classic' style='width:100%' value=\""+qa+"\"/><br><br>{$lang['opt_question_4']}<br /><textarea name='answer' id='answer' class='classic' style='width:100%;height:100px;'>"+ans+"</textarea><input type=\"hidden\" name=\"mod\" value=\"question\"><input type=\"hidden\" name=\"user_hash\" value=\"{$dle_login_hash}\"><input type=\"hidden\" name=\"action\" value=\"editquestion\"><input type=\"hidden\" name=\"id\" value=\""+id+"\"></form></div>");]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/question/editQuestion.php'));

echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/inc/usergroup.php">
		<operation action="before">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . USERPREFIX . "_admin_logs (name, date, ip, action, extras) values ('".$db->safesql($member_id['name'])."', '{$_TIME}', '{$_IP}', '76', '{$group_name}')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
		require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/usergroups/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . USERPREFIX . "_admin_logs (name, date, ip, action, extras) values ('".$db->safesql($member_id['name'])."', '{$_TIME}', '{$_IP}', '77', '{$group_name}')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
		require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/usergroups/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[<tr>
        <td style="width:58%"><h6 class="media-heading text-semibold">{$lang['group_name']}</h6><span class="text-muted text-size-small hidden-xs">{$lang['hint_gtitle']}</span></td>
        <td style="width:42%"><input type="text" class="form-control" name="group_name" value="{$group_name_value}"></td>
    </tr>]]></searchcode>
			<replacecode><![CDATA[
HTML;

// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/usergroups/table.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/modules/addnews.php">
		<operation action="before">
			<searchcode><![CDATA[$answer = $db->super_query("SELECT id, answer FROM " . PREFIX . "_question WHERE id='".intval($_SESSION['question'])."'");]]></searchcode>
			<replacecode><![CDATA[				// MaHarder
				$answerClause = "answer, answer_{$i18n_lang['active'][$i18n->getLocale()]['iso2']}, answer_{$i18n_lang['active'][$languages_config['fallback_language']]['iso2']}";]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$answer = $db->super_query("SELECT id, answer FROM " . PREFIX . "_question WHERE id='".intval($_SESSION['question'])."'");]]></searchcode>
			<replacecode><![CDATA[// MaHarder
				if (!empty($answer['answer_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
					$answer['answer'] = $answer['answer_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
				} elseif (!empty($question['answer_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
					$answer['answer'] = $answer['answer_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
				}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_post set title='$title', short_story='$short_story', full_story='$full_story', xfields='$filecontents', category='$category_list', alt_name='$alt_name', allow_comm='$allow_comm', approve='$approve', allow_main='$allow_main', fixed='$news_fixed', allow_br='$allow_br', tags='" . $_POST['tags'] . "' WHERE id='{$id}'" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
				require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/modules/addnews/updateNews.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_tags (news_id, tag) VALUES " . $tags );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
						require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tags.php'));]]></replacecode>
			<searchcount>2</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$count = $db->super_query( "SELECT COUNT(*) as count FROM " . PREFIX . "_poll WHERE news_id = '{$id}'" );
					
					if( $count['count'] ) $db->query( "UPDATE  " . PREFIX . "_poll set title='$vote_title', frage='$frage', body='$vote_body', multiple='$allow_m_vote' WHERE news_id = '{$row['id']}'" );
					else $db->query( "INSERT INTO " . PREFIX . "_poll (news_id, title, frage, body, votes, multiple, answer) VALUES('{$id}', '$vote_title', '$frage', '$vote_body', 0, '$allow_m_vote', '')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/poll.prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$row['id'] = $db->insert_id();]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
				$id = $row['id'];
				require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/modules/addnews/updateNews.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_poll (news_id, title, frage, body, votes, multiple, answer) VALUES('{$row['id']}', '{$vote_title}', '{$frage}', '{$vote_body}', 0, '{$allow_m_vote}', '')" );]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/poll.prePost.php'));]]></replacecode>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$answer = $db->super_query("SELECT id, answer FROM " . PREFIX . "_question WHERE id='".intval($_SESSION['question'])."'");]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
$answer = $db->super_query("SELECT id, {$answerClause} FROM " . PREFIX . "_question WHERE id='".intval($_SESSION['question'])."'");]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$question = $db->super_query("SELECT id, question FROM " . PREFIX . "_question ORDER BY RAND() LIMIT 1");]]></searchcode>
			<replacecode><![CDATA[			// MaHarder
			$questionClause = "question, question_{$i18n_lang['active'][$i18n->getLocale()]['iso2']}, question_{$i18n_lang['active'][$languages_config['fallback_language']]['iso2']}";
]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$question = $db->super_query("SELECT id, question FROM " . PREFIX . "_question ORDER BY RAND() LIMIT 1");]]></searchcode>
			<replacecode><![CDATA[			// MaHarder
			if (!empty($question['question_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
				$question['question'] = $question['question_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
			} elseif (!empty($question['question_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
				$question['question'] = $question['question_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
			}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$question = $db->super_query("SELECT id, question FROM " . PREFIX . "_question ORDER BY RAND() LIMIT 1");]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
$question = $db->super_query("SELECT id, {$questionClause} FROM " . PREFIX . "_question ORDER BY RAND() LIMIT 1");]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[if( $config['allow_site_wysiwyg'] == "2" ) $save = "tinyMCE.triggerSave();"; else $save = "";]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/modules/addnews/addNews.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/modules/functions.php">
		<operation action="before">
			<searchcode><![CDATA[$returnstring .= '>' . $sublevelmarker . $cat_info[$id]['name'] . '</option>';]]></searchcode>
			<replacecode><![CDATA[					// MaHarder
					if (!empty($cat_info[$id]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
						$cat_info[$id]['name'] = $cat_info[$id]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
					} elseif (!empty($cat_info[$id]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
						$cat_info[$id]['name'] = $cat_info[$id]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
					}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/init.php">
		<operation action="after">
			<searchcode><![CDATA[require_once (DLEPlugins::Check(ENGINE_DIR . '/modules/functions.php'));]]></searchcode>
			<replacecode><![CDATA[// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/languages.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/modules/show.custom.php">
		<operation action="before">
			<searchcode><![CDATA[$my_cat[] = $cat_info[$cat_list[0]]['name'];]]></searchcode>
			<replacecode><![CDATA[				// MaHarder
				if (!empty($cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
					$cat_info[$cat_list[0]]['name'] = $cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
				} elseif (!empty($cat_info[$id]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
					$cat_info[$cat_list[0]]['name'] =$cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
				}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$my_cat[] = $cat_info[$element]['name'];]]></searchcode>
			<replacecode><![CDATA[					// MaHarder
					if (!empty($cat_info[$element]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
						$cat_info[$element]['name'] = $cat_info[$element]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
					} elseif (!empty($cat_info[$element]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
						$cat_info[$element]['name'] = $cat_info[$element]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
					}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$row['title'] = stripslashes( $row['title'] );]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	include (DLEPlugins::Check(MH_DIR . '/include/modules/show.custom/langReplacer.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/modules/show.full.php">
		<operation action="before">
			<searchcode><![CDATA[$options = news_permission( $row['access'] );]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	require_once (DLEPlugins::Check(MH_DIR . '/include/modules/show.custom/langReplacer.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$my_cat[] = $cat_info[$cat_list[0]]['name'];]]></searchcode>
			<replacecode><![CDATA[				// MaHarder
				if (!empty($cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
					$cat_info[$cat_list[0]]['name'] = $cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
				} elseif (!empty($cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
					$cat_info[$cat_list[0]]['name'] = $cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
				}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$my_cat[] = $cat_info[$element]['name'];]]></searchcode>
			<replacecode><![CDATA[					// MaHarder
					if (!empty($cat_info[$element]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
						$cat_info[$id]['name'] = $cat_info[$element]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
					} elseif (!empty($cat_info[$element]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
						$cat_info[$element]['name'] = $cat_info[$element]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
					}]]></replacecode>
			<searchcount>2</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$row_link = $db->super_query( "SELECT id, date, title, category, alt_name FROM " . PREFIX . "_post WHERE category = '{$row['category']}' AND date >= '{$row['date']}'{$where_date} AND id != '{$row['id']}' AND approve = '1' ORDER BY date ASC LIMIT 1" );]]></searchcode>
			<replacecode><![CDATA[				// MaHarder
				$titleClause = ['title'];
				foreach ($i18n_lang['active'] as $code => $lang_ar) {
					$iso = $lang_ar['iso2'];
					$titleClause[] = "title_{$iso}";
				}
				$titleClause = implode(', ', $titleClause);
				$row_link = $db->super_query( "SELECT id, date, {$titleClause}, category, alt_name FROM " . PREFIX . "_post WHERE category = '{$row['category']}' AND date >= '{$row['date']}'{$where_date} AND id != '{$row['id']}' AND approve = '1' ORDER BY date ASC LIMIT 1" );
				// MaHarder
				if (!empty($row_link['title_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
					$row_link['title'] = $row_link['title_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
				} elseif (!empty($row_link['title_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
					$row_link['title'] = $row_link['title_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
				}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$row_link = $db->super_query( "SELECT id, date, title, category, alt_name FROM " . PREFIX . "_post WHERE category = '{$row['category']}' AND date <= '{$row['date']}'{$where_date} AND id != '{$row['id']}' AND approve = '1' ORDER BY date DESC LIMIT 1" );]]></searchcode>
			<replacecode><![CDATA[				// MaHarder
				$titleClause = ['title'];
				foreach ($i18n_lang['active'] as $code => $lang_ar) {
					$iso = $lang_ar['iso2'];
					$titleClause[] = "title_{$iso}";
				}
				$titleClause = implode(', ', $titleClause);
				$row_link = $db->super_query( "SELECT id, date, {$titleClause}, category, alt_name FROM " . PREFIX . "_post WHERE category = '{$row['category']}' AND date <= '{$row['date']}'{$where_date} AND id != '{$row['id']}' AND approve = '1' ORDER BY date DESC LIMIT 1" );

				// MaHarder
				if (!empty($row_link['title_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
					$row_link['title'] = $row_link['title_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
				} elseif (!empty($row_link['title_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
					$row_link['title'] = $row_link['title_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
				}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$social_tags['site_name'] = $config['home_title'];]]></searchcode>
			<replacecode><![CDATA[		// TODO
		// Config implementieren
		// MaHarder
		if (!empty($config['home_title_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
			$config['home_title'] = $config['home_title_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
		} elseif (!empty($config['home_title_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
			$config['home_title'] = $config['home_title_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
		}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$db->query( "SELECT id, date, short_story, xfields, title, category, alt_name FROM " . PREFIX . "_post WHERE id IN({$row['related_ids']}) AND approve=1 ORDER BY FIND_IN_SET(id, '{$row['related_ids']}') LIMIT " . $config['related_number'] );]]></searchcode>
			<replacecode><![CDATA[					// MaHarder
					$selectClause = ['title', 'short_story'];
					foreach ($i18n_lang['active'] as $code => $lang_ar) {
						$iso = $lang_ar['iso2'];
						$selectClause[] = "title_{$iso}";
						$selectClause[] = "short_story_{$iso}";
					}
					$selectClause = implode(', ', $selectClause);
					$db->query( "SELECT id, date, {$selectClause}, xfields, category, alt_name FROM " . PREFIX . "_post WHERE id IN({$row['related_ids']}) AND approve=1 ORDER BY FIND_IN_SET(id, '{$row['related_ids']}') LIMIT " . $config['related_number'] );]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$db->query( "SELECT id, date, short_story, xfields, title, category, alt_name, MATCH (title, short_story, full_story, xfields) AGAINST ('{$body}') as score FROM " . PREFIX . "_post {$join_category}WHERE {$where_category}{$allowed_cats}{$not_allowed_cats}MATCH (title, short_story, full_story, xfields) AGAINST ('{$body}') AND id != " . $row['id'] . " AND approve=1" . $where_date . " ORDER BY score DESC LIMIT " . $config['related_number'] );]]></searchcode>
			<replacecode><![CDATA[// MaHarder
					$selectClause = ['title', 'short_story'];
					$matchClause = ['title', 'short_story', 'full_story'];
					foreach ($i18n_lang['active'] as $code => $lang_ar) {
						$iso = $lang_ar['iso2'];
						$selectClause[] = "title_{$iso}";
						$selectClause[] = "short_story_{$iso}";
						$matchClause[] = "title_{$iso}";
						$matchClause[] = "short_story_{$iso}";
						$matchClause[] = "full_story_{$iso}";
					}
					$selectClause = implode(', ', $selectClause);
					$matchClause = implode(', ', $matchClause);
					$db->query( "SELECT id, date, xfields, {$selectClause}, alt_name, MATCH ({$matchClause}, xfields) AGAINST ('{$body}') as score FROM " . PREFIX . "_post {$join_category}WHERE {$where_category}{$allowed_cats}{$not_allowed_cats}MATCH ({$matchClause}, xfields) AGAINST ('{$body}') AND id != " . $row['id'] . " AND approve=1" . $where_date . " ORDER BY score DESC LIMIT " . $config['related_number'] );]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$my_cat[] = $cat_info[$rel_cat_list[0]]['name'];]]></searchcode>
			<replacecode><![CDATA[								// MaHarder
								if (!empty($cat_info[$rel_cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
									$cat_info[$rel_cat_list[0]]['name'] = $cat_info[$rel_cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
								} elseif (!empty($cat_info[$rel_cat_list[0]]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
									$cat_info[$rel_cat_list[0]]['name'] = $cat_info[$rel_cat_list[0]]['name_' .
									$i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
								}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[while ( $related = $db->get_row() ) {]]></searchcode>
			<replacecode><![CDATA[					// MaHarder
					include (DLEPlugins::Check(MH_DIR . '/include/modules/show.full/langReplacerRelated.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/modules/show.short.php">
		<operation action="after">
			<searchcode><![CDATA[while ( $row = $db->get_row( $sql_result ) ) {]]></searchcode>
			<replacecode><![CDATA[		// MaHarder
		include (DLEPlugins::Check(MH_DIR . '/include/modules/show.custom/langReplacer.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$my_cat[] = $cat_info[$cat_list[0]]['name'];]]></searchcode>
			<replacecode><![CDATA[					// MaHarder
					if (!empty($cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
						$cat_info[$cat_list[0]]['name'] = $cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
					} elseif (!empty($cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
						$cat_info[$cat_list[0]]['name'] = $cat_info[$cat_list[0]]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
					}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$my_cat[] = $cat_info[$element]['name'];]]></searchcode>
			<replacecode><![CDATA[						// MaHarder
						if (!empty($cat_info[$element]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
							$cat_info[$element]['name'] = $cat_info[$element]['name_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
						} elseif (!empty($cat_info[$element]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
							$cat_info[$element]['name'] = $cat_info[$element]['name_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
						}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/modules/favorites.php">
		<operation action="replace">
			<searchcode><![CDATA[$sql_select = "SELECT p.id, p.autor, p.date, p.short_story, CHAR_LENGTH(p.full_story) as full_story, p.xfields, p.title, p.category, p.alt_name, p.comm_num, p.allow_comm, p.fixed, p.tags, e.news_read, e.allow_rate, e.rating, e.vote_num, e.votes, e.view_edit, e.editdate, e.editor, e.reason FROM " . PREFIX . "_post p {$cat_join}LEFT JOIN " . PREFIX . "_post_extras e ON (p.id=e.news_id) WHERE {$stop_list}approve=1 AND id in $favorites " .$order_list . "LIMIT " . $cstart . "," . $config['news_number'];]]></searchcode>
			<replacecode><![CDATA[// MaHarder
$selectClause = [];
foreach ($i18n_lang['active'] as $code => $lang_ar) {
	$iso = $lang_ar['iso2'];
	$selectClause[] = "p.title_{$iso}";
	$selectClause[] = "CHAR_LENGTH(p.full_story_{$iso}) as full_story_{$iso}";
	$selectClause[] = "p.short_story_{$iso}";
	$selectClause[] = "p.tags_{$iso}";
}
$selectClause = implode(', ', $selectClause);

$sql_select = "SELECT {$selectClause}, p.id, p.autor, p.date, p.short_story, CHAR_LENGTH(p.full_story) as full_story, p.xfields, p.title, p.category, p.alt_name, p.comm_num, p.allow_comm, p.fixed, p.tags, e.news_read, e.allow_rate, e.rating, e.vote_num, e.votes, e.view_edit, e.editdate, e.editor, e.reason FROM " . PREFIX . "_post p {$cat_join}LEFT JOIN " . PREFIX . "_post_extras e ON (p.id=e.news_id) WHERE {$stop_list}approve=1 AND id in $favorites " .$order_list . "LIMIT " . $cstart . "," . $config['news_number'];]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/engine.php">
		<operation action="replace">
			<searchcode><![CDATA[$sql_select = "SELECT p.id,]]></searchcode>
			<replacecode><![CDATA[// MaHarder
$selectClause = [];
foreach ($i18n_lang['active'] as $code => $lang_ar) {
	$iso = $lang_ar['iso2'];
	$selectClause[] = "p.title_{$iso}";
	$selectClause[] = "CHAR_LENGTH(p.full_story_{$iso}) as full_story_{$iso}";
	$selectClause[] = "p.short_story_{$iso}";
	$selectClause[] = "p.tags_{$iso}";
}
$selectClause = implode(', ', $selectClause);

$sql_select = "SELECT p.id, {$selectClause}, ]]></replacecode>
			<searchcount>17</searchcount>
		</operation>
	</file>
	<file name="engine/inc/static.php">
		<operation action="replace">
			<searchcode><![CDATA[		if(!$_REQUEST['search_area']) {
			$where[] = "(name like '%$search_field%' OR template like '%$search_field2%' OR descr like '%$search_field%')";
		} elseif($_REQUEST['search_area'] == 1) {
			$where[] = "name like '%{$search_field}%'";
		} elseif($_REQUEST['search_area'] == 2) {
			$where[] = "descr like '%{$search_field}%'";
		} elseif($_REQUEST['search_area'] == 3) {
			$where[] = "template like '%{$search_field2}%'";
		}]]></searchcode>
			<replacecode><![CDATA[require_once (DLEPlugins::Check(MH_DIR . '/include/inc/static/searchField.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[if( $_REQUEST['search_order_v'] == "asc" or $_REQUEST['search_order_v'] == "desc" ) $search_order_v = $_REQUEST['search_order_v'];
	else $search_order_v = "";]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	if( $_REQUEST['search_lang']  ) $search_lang = $_REQUEST['search_lang'];
	else $search_lang = "";]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$db->query( "SELECT id, name, descr, template, views, date, password FROM " . PREFIX . "_static" . $where . " ORDER BY " . $order_by . " LIMIT $start_from,$news_per_page" );]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	$selectFields = [];
	foreach ($i18n_lang['active'] as $code => $lang_ar) {
		$selectFields[] = "descr_{$lang_ar['iso2']}";
		$selectFields[] = "template_{$lang_ar['iso2']}";
	}
	$selectFields = implode(', ', $selectFields);]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$db->query( "SELECT id, name, descr, template, views, date, password FROM " . PREFIX . "_static" . $where . " ORDER BY " . $order_by . " LIMIT $start_from,$news_per_page" );]]></searchcode>
			<replacecode><![CDATA[$db->query( "SELECT id, name, descr, template, views, date, password, {$selectFields} FROM " . PREFIX . "_static" . $where . " ORDER BY " . $order_by . " LIMIT $start_from,$news_per_page" );]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$descr = stripslashes($row['descr']);]]></searchcode>
			<replacecode><![CDATA[		// MaHarder
		if (!empty($row['descr_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']])) {
			$row['descr'] = $row['descr_' . $i18n_lang['active'][$i18n->getLocale()]['iso2']];
		} elseif (!empty($row['descr_' . $i18n_lang['active'][$languages_config['fallback_language']]['iso2']])) {
			$row['descr'] = $row['descr_'.$i18n_lang['active'][$languages_config['fallback_language']]['iso2']];
		}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[{$lang['static_a']}]]></searchcode>
			<replacecode><![CDATA[<ul class="nav nav-tabs nav-tabs-solid">
		<li class="active"><a href="#native" data-toggle="tab"><i class="fa fa-home position-left"></i> {$lang['static_a']}</a></li>
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tabs.php'));

	echo <<<HTML
	</ul>]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[    </div>
  </div>
  <div class="panel-body">
	
		<div class="form-group">
		  <label class="control-label col-md-2">{$lang['static_title']}</label>]]></searchcode>
			<replacecode><![CDATA[    </div>
  </div>
  <div class="panel-tab-content tab-content">
  <div class="tab-pane active" id="native">
      <div class="panel-body">
	
		<div class="form-group">
		  <label class="control-label col-md-2">{$lang['static_title']}</label>]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[	<div class="panel-footer">
		<button type="submit" class="btn bg-teal btn-sm btn-raised position-left"><i class="fa fa-floppy-o position-left"></i>{$lang['user_save']}</button>]]></searchcode>
			<replacecode><![CDATA[</div>
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/static/tabContent.php'));

	echo <<<HTML
    ]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "INSERT INTO " . PREFIX . "_static (name, descr, template, allow_br, allow_template, grouplevel, tpl, metadescr, metakeys, template_folder, date, metatitle, allow_count, sitemap, disable_index, disable_search, password) values ('$name', '$descr', '$template', '$allow_br', '$allow_template', '$grouplevel', '$tpl', '{$metatags['description']}', '{$metatags['keywords']}', '{$skin_name}', '{$thistime}', '{$metatags['title']}', '$allow_count', '$allow_sitemap', '$disable_index', '$disable_search', '$password')" );]]></searchcode>
			<replacecode><![CDATA[
// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/static/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[if ($row['allow_br'] == 2) {]]></searchcode>
			<replacecode><![CDATA[
// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/static/preEdit.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[  <div class="panel-body">

HTML;
	
	if( $_GET['page'] == "rules" ) {]]></searchcode>
			<replacecode><![CDATA[
  <div class="panel-tab-content tab-content">
  <div class="tab-pane active" id="native">
      <div class="panel-body">

HTML;
	
	if( $_GET['page'] == "rules" ) {]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_static SET descr='$descr', template='$template', allow_br='$allow_br', allow_template='$allow_template', grouplevel='all', tpl='$tpl', metadescr='{$metatags['description']}', metakeys='{$metatags['keywords']}', template_folder='{$skin_name}', date='{$thistime}', metatitle='{$metatags['title']}', allow_count='{$allow_count}', sitemap='0', disable_index='0', disable_search='{$disable_search}', password='' WHERE name='dle-rules-page'" );]]></searchcode>
			<replacecode><![CDATA[
// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/static/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_static_files SET static_id='{$row}' WHERE author = '{$member_id['name']}' AND static_id = '0'" );]]></searchcode>
			<replacecode><![CDATA[
// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/static/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[$db->query( "UPDATE " . PREFIX . "_static SET name='$name', descr='$descr', template='$template', allow_br='$allow_br', allow_template='$allow_template', grouplevel='$grouplevel', tpl='$tpl', metadescr='{$metatags['description']}', metakeys='{$metatags['keywords']}', template_folder='{$skin_name}', date='{$thistime}', metatitle='{$metatags['title']}', allow_count='{$allow_count}', sitemap='{$allow_sitemap}', disable_index='$disable_index', disable_search='{$disable_search}', password='{$password}' WHERE id='$id'" );]]></searchcode>
			<replacecode><![CDATA[
// MaHarder Assets
require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/static/prePost.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[{$lang['static_edit']}]]></searchcode>
			<replacecode><![CDATA[<ul class="nav nav-tabs nav-tabs-solid">
		<li class="active"><a href="#native" data-toggle="tab"><i class="fa fa-home position-left"></i> {$lang['static_edit']}</a></li>
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/addnews/tabs.php'));

	echo <<<HTML
	</ul>]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[<div class="panel-footer">
	<button class="btn bg-teal btn-sm btn-raised position-left" type="submit">]]></searchcode>
			<replacecode><![CDATA[</div>
HTML;
// MaHarder Assets
	require_once (DLEPlugins::Check(ENGINE_DIR . '/inc/maharder/assets/include/inc/static/tabContent.php'));

	echo <<<HTML]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/modules/static.php">
		<operation action="after">
			<searchcode><![CDATA[if( $static_result['id'] ) {]]></searchcode>
			<replacecode><![CDATA[
// MaHarder
	require_once (DLEPlugins::Check(MH_DIR . '/include/modules/static/replacer.php'));]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/classes/templates.class.php">
		<operation action="before">
			<searchcode><![CDATA[function set($name, $var) {]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	function translate_text( $matches=array() ) {

		$matches[1] = strip_tags($matches[1] );
		$matches[1] = str_replace(' ', '', $matches[1] );

		$type = $matches[1];
		$text = translate(trim($matches[2]));

		return $text;
	}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[		if( strpos( $this->template, "{include file=" ) !== false ) {
			$this->include_mode = 'tpl';			
			$this->template = preg_replace_callback( "#\\{include file=['\"](.+?)['\"]\\}#i", array( &$this, 'load_file'), $this->template );
		
		}]]></searchcode>
			<replacecode><![CDATA[		// MaHarder
		if( strpos( $this->template, "{trans" ) !== false ) {
			$this->copy_template = preg_replace_callback( "#\\{trans (.+?)=['\"](.+?)['\"]\\}#i", array( &$this, 'translate_text'), $this->copy_template );
		}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[		if( strpos( $this->template, "{include file=" ) !== false ) {
			$this->include_mode = 'php';			
			$this->copy_template = preg_replace_callback( "#\\{include file=['\"](.+?)['\"]\\}#i", array( &$this, 'load_file'), $this->copy_template );
		
		}]]></searchcode>
			<replacecode><![CDATA[		// MaHarder
		if( strpos( $this->template, "{trans" ) !== false ) {
			$this->copy_template = preg_replace_callback( "#\\{trans (.+?)=['\"](.+?)['\"]\\}#i", array( &$this, 'translate_text'), $this->copy_template );
		}]]></replacecode>
			<searchcount>1</searchcount>
		</operation>
	</file>
	<file name="engine/classes/uploads/upload.class.php">
		<operation action="replace">
			<searchcode><![CDATA[$this->area = totranslit($area);]]></searchcode>
			<replacecode><![CDATA[		// MaHarder
		if (is_array($area)) {
			$this->area = totranslit('maharder');
			$this->model_name = totranslit($area[1]);
			$this->model_field = $area[2];
		} else {
			$this->area = totranslit($area);
		}]]></replacecode>
			<searchcount>1</searchcount>
			<replacecount>1</replacecount>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[				if( $this->area == "template" ) {
					
					$db->query( "INSERT INTO " . PREFIX . "_static_files (static_id, author, date, name, onserver, size, checksum) values ('{$this->news_id}', '{$this->author}', '{$added_time}', '{$filename}', '". FOLDER_PREFIX ."{$uploaded_filename}', '{$size}', '{$md5}')" );
					$id = $db->insert_id();]]></searchcode>
			<replacecode><![CDATA[				// MaHarder
				if( $this->area == "template" || $this->area == 'maharder' ) {

					// MaHarder
					if ($this->area == 'maharder' && !empty($this->model_name) && !empty($this->model_field)) {
						$thisType = 'file';
						if( in_array( $type, $this->allowed_video ) ) $thisType = 'video';
						elseif( in_array( $type, $this->allowed_extensions ) ) $thisType = 'image';
						$db->query( "INSERT INTO {$this->model_field} (name, model_name, model_id, path, hash, uploader, size, type) values ('{$filename}', '{$this->model_name}','{$this->news_id}', '". FOLDER_PREFIX ."{$uploaded_filename}', '{$md5}', '{$this->author}', '{$size}', '{$thisType}')" );
					} else {
						$db->query("INSERT INTO ".PREFIX."_static_files (static_id, author, date, name, onserver, size, checksum) values ('{$this->news_id}', '{$this->author}', '{$added_time}', '{$filename}', '".FOLDER_PREFIX."{$uploaded_filename}', '{$size}', '{$md5}')");
					}]]></replacecode>
		</operation>
		<operation action="replace">
			<searchcode><![CDATA[$return_box = "<div class=\"uploadedfile\"><div class=\"info\">{$filename}</div><div class=\"uploadimage\"><a class=\"uploadfile\" href=\"{$data_url}\" data-src=\"{$id}:{$filename}\" data-type=\"file\" data-play=\"{$file_play}\"><img style=\"width:auto;height:auto;max-width:100px;max-height:90px;\" src=\"" . $file_link . "\" /></a></div><div class=\"info\"><input type=\"checkbox\" id=\"file\" name=\"static_files[]\" value=\"{$id}\" data-type=\"file\">&nbsp;".formatsize($size)."</div></div>";]]></searchcode>
			<replacecode><![CDATA[// MaHarder
					if ($this->area == 'maharder')
						$return_box = "<div class=\"uploadedfile\"><div class=\"info\">{$filename}</div><div class=\"uploadimage\"><a class=\"uploadfile\" href=\"{$data_url}\" data-src=\"{$id}:{$filename}\" data-type=\"file\" data-play=\"{$file_play}\"><img style=\"width:auto;height:auto;max-width:100px;max-height:90px;\" src=\"" . $file_link . "\" /></a></div><div class=\"info\"><input type=\"checkbox\" id=\"file\" name=\"files[]\" value=\"{$id}\" data-type=\"file\">&nbsp;".formatsize($size)."</div></div>";
					else
						$return_box = "<div class=\"uploadedfile\"><div class=\"info\">{$filename}</div><div class=\"uploadimage\"><a class=\"uploadfile\" href=\"{$data_url}\" data-src=\"{$id}:{$filename}\" data-type=\"file\" data-play=\"{$file_play}\"><img style=\"width:auto;height:auto;max-width:100px;max-height:90px;\" src=\"" . $file_link . "\" /></a></div><div class=\"info\"><input type=\"checkbox\" id=\"file\" name=\"static_files[]\" value=\"{$id}\" data-type=\"file\">&nbsp;".formatsize($size)."</div></div>";]]></replacecode>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[				if( $this->area == "template" ) {
					
					$inserts = FOLDER_PREFIX . $uploaded_filename;
					$db->query( "INSERT INTO " . PREFIX . "_static_files (static_id, author, date, name) values ('{$this->news_id}', '{$this->author}', '{$added_time}', '{$inserts}')" );
					$id = $db->insert_id();				
				}]]></searchcode>
			<replacecode><![CDATA[				// MaHarder
				if( $this->area == "maharder" && !empty($this->model_name) && !empty($this->model_field)) {

					$inserts = FOLDER_PREFIX . $uploaded_filename;
					$db->query( "INSERT INTO {$this->model_field} (name, model_name, model_id, uploader, type) values ('{$inserts}', '{$this->model_name}', '{$this->news_id}', '{$this->author}', 'image')" );
					$id = $db->insert_id();
				}]]></replacecode>
			<searchcount>1</searchcount>
			<replacecount>1</replacecount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[elseif( $this->area != "template" ) {
				
					$return_box = "<div class=\"uploadedfile\"><div class=\"info\">{$filename}</div><div class=\"uploadimage\"><a class=\"uploadfile\" href=\"{$data_url}\" data-src=\"{$data_url}\" data-thumb=\"{$thumb_data}\" data-medium=\"{$medium_data}\" data-type=\"image\"><img style=\"width:auto;height:auto;max-width:100px;max-height:90px;\" src=\"" . $img_url . "\" /></a></div><div class=\"info\"><input type=\"checkbox\" name=\"images[" . FOLDER_PREFIX . $uploaded_filename . "]\" value=\"" . FOLDER_PREFIX . $uploaded_filename . "\" data-thumb=\"{$thumb_data}\" data-medium=\"{$medium_data}\" data-type=\"image\" data-src=\"{$data_url}\">&nbsp;{$i_info[0]}x{$i_info[1]}</div></div>";
				
				}]]></searchcode>
			<replacecode><![CDATA[elseif( $this->area == "maharder" ) {

					$return_box = "<div class=\"uploadedfile\"><div class=\"info\">{$filename}</div><div class=\"uploadimage\"><a class=\"uploadfile\" href=\"{$data_url}\" data-src=\"{$data_url}\" data-thumb=\"{$thumb_data}\" data-medium=\"{$medium_data}\" data-type=\"image\"><img style=\"width:auto;height:auto;max-width:100px;max-height:90px;\" src=\"" . $img_url . "\" /></a></div><div class=\"info\"><input type=\"checkbox\" name=\"files[]\" value=\"{$id}\" data-thumb=\"{$thumb_data}\" data-medium=\"{$medium_data}\" data-type=\"image\" data-src=\"{$data_url}\">&nbsp;{$i_info[0]}x{$i_info[1]}</div></div>";

				}]]></replacecode>
			<searchcount>1</searchcount>
			<replacecount>1</replacecount>
		</operation>
		<operation action="after">
			<searchcode><![CDATA[private $use_prefix = true;]]></searchcode>
			<replacecode><![CDATA[	// MaHarder
	private $model_name = '';
	private $model_field = '';]]></replacecode>
			<searchcount>1</searchcount>
			<replacecount>1</replacecount>
		</operation>
	</file>
</dleplugin>